/*! jepun 2018-03-29 */
$(document).ready(function(){function a(a){if(null!==a&&void 0!==a){var d={};d.url=jCom.urlPath("BackAdmin/GetEmp2"),d.reload=!0,d.Pno=a,$.when(c.addSelect("EmpNo",d)).then(function(){0===a?c.getCtrl("EmpNo")[0].selectedIndex=0:c.getCtrl("EmpNo").val(a),b(c.getCtrl("EmpNo").val())})}}function b(a){c.getCtrl("BtnUpd,BtnDel,BtnBack").addClass("hidden"),null!==a&&void 0!==a&&c.callDataBus("BackAdmin/GetEmp",{Pno:a})}var c=$("#FormBackAdmin").comm();c.addHandler("Ini",function(b){c.addSelect("Role",jFun.getOptionsUrl("Role",1)),a(0)}),c.addHandler("BtnIns",function(b){a(b.Pno)}),c.addHandler("BtnUpd",function(b){a(c.getCtrl("EmpNo").val())}),c.addHandler("BtnDel",function(b){a(c.getCtrl("EmpNo").val())}),c.addHandler("BtnBack",function(b){a(c.getCtrl("EmpNo").val())}),c.addHandler("GetEmp",function(a){var b=$.parseJSON(a.obj);b.length>0&&$.when(c.formInject(b[0])).then(function(){"-1"===c.getCtrl("EmpNo").val()?c.getCtrl("BtnIns").removeClass("hidden"):(c.getCtrl("BtnUpd,BtnDel,BtnBack").removeClass("hidden"),c.getCtrl("BtnIns").addClass("hidden"),c.valid())})}),c.getCtrl("EmpNo").on("click",function(a){a.preventDefault();var c=$(this);b(c.val())}),c.getCtrl("BtnIns").on("click",function(a){if(a.preventDefault(),c.valid())return"-1"===c.getCtrl("Role").val()?void jCom.Alert("","請選擇身份"):void c.callDataBus("BackAdmin/Ins",c.formToJSON())}),c.getCtrl("BtnUpd").on("click",function(a){if(a.preventDefault(),c.valid())return"-1"===c.getCtrl("Role").val()?void jCom.Alert("","請選擇身份"):void c.callDataBus("BackAdmin/Upd",c.formToJSON())}),c.getCtrl("BtnDel").on("click",function(a){a.preventDefault(),c.callDataBus("BackAdmin/Del",{Pno:c.getCtrl("Pno").val(),LogSN:c.getCtrl("LogSN").val()})}),c.getCtrl("BtnBack").on("click",function(a){a.preventDefault(),c.valid()&&c.callDataBus("BackAdmin/Back",c.formToJSON())})});